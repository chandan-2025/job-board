
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Community Job Board</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f9f9f9;
    }

    header {
      background-color: #1976d2;
      color: white;
      padding: 1rem;
      text-align: center;
    }

    h1 {
      margin: 0;
      font-size: 1.8rem;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 20px;
      overflow-x: auto;
    }

    .filter-group {
      display: flex;
      flex-direction: row;
      flex-wrap: nowrap;
      justify-content: center;
      gap: 12px;
      margin-bottom: 25px;
      align-items: center;
      min-width: 320px;
    }

    .filter-group select,
    .filter-group input {
      flex: 1 1 160px;
      padding: 10px 12px;
      font-size: 16px;
      border-radius: 4px;
      border: 1px solid #ccc;
      box-sizing: border-box;
      min-width: 140px;
      max-width: 250px;
    }

    .filter-group button {
      padding: 10px 20px;
      font-size: 16px;
      background-color: #1976d2;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      flex-shrink: 0;
      transition: background-color 0.3s ease;
      white-space: nowrap;
    }

    .filter-group button:hover {
      background-color: #155a9c;
    }

    #resultsContainer {
      background: white;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      overflow-x: auto;
    }

    .result-item {
      border-bottom: 1px solid #eee;
      padding: 10px 0;
    }

    .result-item:last-child {
      border-bottom: none;
    }

    @media (max-width: 768px) {
      .filter-group {
        flex-wrap: wrap;
        justify-content: flex-start;
      }

      .filter-group select,
      .filter-group input,
      .filter-group button {
        flex: 1 1 100%;
        max-width: 100%;
      }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

</head>
<body>

  <header>
    <h1>Community Job Board</h1>
  </header>

  <div class="container">

    <div class="filter-group" id="filterGroup">
      <select id="roleFilter">
        <option value="All">All Roles</option>
        <option value="Job Seeker">Job Seeker</option>
        <option value="Referrer">Referrer</option>
      </select>

      <input type="text" id="locationFilter" placeholder="Location" />
      <input type="text" id="experienceFilter" placeholder="Experience (e.g., 2 years)" />
      <input type="text" id="companyFilter" placeholder="Company Name" />

      <button onclick="applyFilters()">Search</button>
    </div>

    <div id="resultsContainer"></div>

  </div>

<script>
  const CSV_URL = 'https://cors-anywhere.herokuapp.com/https://docs.google.com/spreadsheets/d/e/2PACX-1vS47IVX2PkhWMfZO57GjftGkUJSAX1pBMxJ5FUou4RY86T3cfpksGzD9hICU6R_VIYIPgeOu66g-fXS/pub?output=csv';

  function applyFilters() {
    const role = document.getElementById("roleFilter").value.trim().toLowerCase();
    const location = document.getElementById("locationFilter").value.trim().toLowerCase();
    const experience = document.getElementById("experienceFilter").value.trim();
    const company = document.getElementById("companyFilter").value.trim().toLowerCase();

    if (experience && !/^\d+$/.test(experience)) {
      alert("Experience must be a valid number.");
      return;
    }

    // Hide filter while fetching data
    document.getElementById("filterGroup").style.display = "none";

    Papa.parse(CSV_URL, {
      download: true,
      header: true,
      skipEmptyLines: true,
      complete: function(results) {
        const data = results.data;

        const filtered = data.filter(entry => {
          const entryRole = entry.role?.toLowerCase() || "";
          const entryLocation = entry.location?.toLowerCase() || "";
          const entryExperience = entry.experience?.toLowerCase() || "";
          const entryCompany = entry["company name"]?.toLowerCase() || "";

          return (
            (
              role === "all" ||
              (role === "job seeker" && entryRole === "referrer") ||
              (role === "referrer" && entryRole === "job seeker")
            ) &&
            (location === "" || entryLocation.includes(location)) &&
            (experience === "" || entryExperience.includes(experience)) &&
            (company === "" || entryCompany.includes(company))
          );
        });

        displayResults(filtered, role);
      },
      error: function(err) {
        console.error(err);
        document.getElementById("resultsContainer").innerHTML = "‚ùå Failed to load data.";
      }
    });
  }

  function displayResults(data, role) {
    const resultsContainer = document.getElementById("resultsContainer");
    let html = "<h3>Filtered Results</h3>";

    if (data.length === 0) {
      html += "<p>No matching results found.</p>";
    } else {
      data.forEach(entry => {
        html += "<div class='result-item'>";

        if (role === "referrer") {
          // Show Job Seeker info
          html += `<p><strong>Name:</strong> ${entry["name"] || ""}</p>`;
          html += `<p><strong>Job Title:</strong> ${entry["job title"] || ""}</p>`;
          html += `<p><strong>Skills:</strong> ${entry["skills"] || ""}</p>`;
          html += `<p><strong>Experience:</strong> ${entry["experience"] || ""}</p>`;
          html += `<p><strong>Preferred Location:</strong> ${entry["preferred location"] || ""}</p>`;
        } else if (role === "job seeker") {
          // Show Referrer info
          html += `<p><strong>Referrer's Name:</strong> ${entry["referrer name"] || ""}</p>`;
          html += `<p><strong>Company Name:</strong> ${entry["company name"] || ""}</p>`;
          html += `<p><strong>Job Title:</strong> ${entry["job title"] || ""}</p>`;
          html += `<p><strong>Referral Link:</strong> ${entry["referral link"] || ""}</p>`;
          html += `<p><strong>Job Description:</strong> ${entry["job description"] || ""}</p>`;
          html += `<p><strong>Required Skills:</strong> ${entry["required skills"] || ""}</p>`;
          html += `<p><strong>Location:</strong> ${entry["location"] || ""}</p>`;
        }

        html += "</div>";
      });
    }

    html += `<button onclick="goBackToFilters()" style="margin-top:20px; padding:10px 16px; font-size:16px; background:#555; color:white; border:none; border-radius:4px; cursor:pointer;">Back to Filters</button>`;
    resultsContainer.innerHTML = html;
  }

  function goBackToFilters() {
    document.getElementById("filterGroup").style.display = "flex";
    document.getElementById("roleFilter").value = "All";
    document.getElementById("locationFilter").value = "";
    document.getElementById("experienceFilter").value = "";
    document.getElementById("companyFilter").value = "";
    document.getElementById("resultsContainer").innerHTML = "";
  }
</script>

</body>
</html>
